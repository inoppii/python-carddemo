# COUSR01C 詳細設計書

## 1. 概要

`COUSR01C` は、システムに新しいユーザーを追加登録するための CICS オンラインプログラムです。
ユーザー名、ID、パスワード、およびユーザータイプ（管理者/一般）を入力し、`USRSEC` ファイルに新規レコードを書き込みます。

## 2. プログラム情報

- **プログラム ID**: `COUSR01C`
- **作成者**: AWS
- **タイプ**: CICS COBOL, VSAM, BMS
- **トランザクション ID**: `CU01`
- **マップセット**: `COUSR01`
- **マップ名**: `COUSR1A`

## 3. 入出力定義

### 3.1. 画面 (BMS)

- **マップセット**: `COUSR01`
- **主要入力フィールド**:
  - `FNAMEI`: 名 (First Name) - 必須
  - `LNAMEI`: 姓 (Last Name) - 必須
  - `USERIDI`: ユーザー ID - 必須
  - `PASSWDI`: パスワード - 必須
  - `USRTYPEI`: ユーザータイプ (Admin/Regular) - 必須

### 3.2. VSAM ファイル

- **USRSEC**: ユーザーセキュリティファイル。`WRITE` 処理を実行。

## 4. 処理ロジック詳細

### 4.1. 初期表示 (MAIN-PARA)

- 画面をクリアし、最初の入力項目 (`FNAME`) にカーソルをセット。

### 4.2. 入力検証 (`PROCESS-ENTER-KEY`)

- すべての項目が入力されているかチェック。
- いずれかが空または初期値の場合、エラーメッセージを表示し、該当項目へカーソルを制御。

### 4.3. 登録処理 (`WRITE-USER-SEC-FILE`)

- 入力されたデータを `SEC-USER-DATA` レコード形式にセット。
- `EXEC CICS WRITE` を実行。
- **正常終了**: 「User XXX has been added」を表示し、入力欄をクリア。
- **重複エラー (`DUPREC`)**: 「User ID already exist」を表示。ユーザー ID の入力を促す。
- **その他エラー**: 一般的なエラーメッセージを表示。

### 4.4. 画面制御

- **F3 (PF3)**: 管理メニュー (`COADM01C`) へ戻る。
- **F4 (PF4)**: 現在の入力をクリアしてリセット。

## 5. エラーハンドリング

- ファイル書き込み時の例外 (Duplicate Key など) を CICS RESP コードで判定し、適切に画面へフィードバック。
- 入力不備がある場合は、処理を続行せずエラーを表示。

## 6. 特記事項

- パスワードなどの秘匿情報は画面上でマスクされている必要があるが、本プログラムは入力値をそのままファイルへ書き込むシンプルな登録機能となっている。
