# COUSR03C 詳細設計書

## 1. 概要

`COUSR03C` は、既存ユーザーをシステムから削除するための CICS オンラインプログラムです。
指定されたユーザー ID の情報を確認画面として表示し、ユーザーの明示的な操作により `USRSEC` ファイルからレコードを物理削除します。

## 2. プログラム情報

- **プログラム ID**: `COUSR03C`
- **作成者**: AWS
- **タイプ**: CICS COBOL, VSAM, BMS
- **トランザクション ID**: `CU03`
- **マップセット**: `COUSR03`
- **マップ名**: `COUSR3A`

## 3. 入出力定義

### 3.1. 画面 (BMS)

- **マップセット**: `COUSR03`
- **主要フィールド**:
  - `USRIDINI`: 削除対象のユーザー ID。
  - `FNAMEI` / `LNAMEI`: 表示用（姓名）。
  - `USRTYPEI`: 表示用（ユーザータイプ）。

### 3.2. VSAM ファイル

- **USRSEC**: ユーザーセキュリティファイル。`READ UPDATE`, `DELETE` 処理を実行。

## 4. 処理ロジック詳細

### 4.1. データ取得と確認表示 (`PROCESS-ENTER-KEY`)

- 指定されたユーザー ID をキーに `READ` を実行。
- ユーザーが存在すれば、その情報を画面に表示し、「Press PF5 key to delete...」という案内をメッセージエリアに出力。

### 4.2. 削除処理 (`DELETE-USER-INFO` -> `DELETE-USER-SEC-FILE`)

1. **再確認とロック**: `PF5` 押下時、再度 `READ UPDATE` でレコードを読み込み、削除対象を確定・ロックする。
2. **実行**: `EXEC CICS DELETE` を発行。
3. **結果**: 正常終了後、画面を初期化し「User XXX has been deleted」を表示。

### 4.3. 画面遷移

- **F3 (PF3)**: 処理をキャンセルして前の画面に戻る。
- **F5 (PF5)**: 削除実行。
- **F12 (PF12)**: 管理メニュー (`COADM01C`) へ戻る。

## 5. エラーハンドリング

- 指定 ID が見つからない場合のエラー出力。
- 削除実行の直前に他者が削除した場合の NOTFND エラー対応。

## 6. 特記事項

- 誤操作による削除を防ぐため、一度データを表示して確認させ、特定のファンクションキー (PF5) 押下によってのみ実行される二段構えのインターフェースとなっている。
- 物理削除が行われるため、一度削除したユーザー ID は即座に再利用可能（新規追加可能）になる。
