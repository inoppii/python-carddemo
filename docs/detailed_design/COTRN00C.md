# COTRN00C 詳細設計書

## 1. 概要

`COTRN00C` は、`TRANSACT` ファイルに記録された取引履歴の一覧を表示する CICS プログラムです。ユーザーは取引 ID を指定して特定の箇所からリストを開始したり、PF7/PF8 キーを使用してページ送りをしたりできます。また、一覧から特定の取引を選択して詳細画面 (`COTRN01C`) へ遷移することが可能です。

## 2. プログラム情報

- **プログラム ID**: `COTRN00C`
- **作成者**: AWS
- **タイプ**: CICS COBOL, VSAM, BMS
- **トランザクション ID**: `CT00`
- **マップセット**: `COTRN00`
- **マップ名**: `COTRN0A`

## 3. 入出力定義

### 3.1. 画面 (BMS)

- **主要フィールド**:
  - `TRNIDINI`: 検索開始位置となる取引 ID。
  - `SEL0001` 〜 `SEL0010`: 各行の選択フィールド ('S' で詳細表示)。
  - `TRNID01` 〜 `TRNID10`: 取引 ID 表示。
  - `PAGENUMI`: 現在のページ番号。

### 3.2. VSAM ファイル

- **TRANSACT**: 取引履歴ファイル。 `STARTBR`, `READNEXT`, `READPREV` を使用してブラウズ。

## 4. 処理ロジック詳細

### 4.1. 初期表示 / 検索 (`PROCESS-ENTER-KEY`)

1. **開始キー設定**: `TRNIDINI` が入力されていればそれを、空であれば `LOW-VALUES` を `TRAN-ID` にセット。
2. **データ取得 (`PROCESS-PAGE-FORWARD`)**: `STARTBR` 後、`READNEXT` を最大 10 回繰り返して画面の各行を埋める。

### 4.2. ページング処理

- **PF8 (次ページ)**: 現在のページの最後の ID から `READNEXT` を実行し、次の 10 件を表示。
- **PF7 (前ページ)**: 現在のページの最初の ID から `READPREV` を実行し、前の 10 件を表示。

### 4.3. 詳細画面への遷移

- 選択フィールドに 'S' が入力された場合、該当行の `TRAN-ID` を COMMAREA にセットし、`COTRN01C` へ `XCTL` する。

## 5. エラーハンドリング

- 数値以外の取引 ID 入力チェック。
- ファイルの終端 (EOF) または先頭に達した際のメッセージ表示。

## 6. 特記事項

- 大容量の取引データを効率的にブラウズするために、標準的な CICS ファイルブラウジング (`STARTBR`/`READNEXT`) パターンを採用している。
